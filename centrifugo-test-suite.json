{
  "name": "Centrifugo - Admin UI, HTTP API, WebSocket, SSE, HTTP-Streaming, and gRPC",
  "description": "Verify Centrifugo admin dashboard status and actions, HTTP API methods (publish, subscribe, presence, history, info, channels, broadcast, disconnect), real-time messaging via WebSocket bidirectional transport, Server-Sent Events (SSE) unidirectional streaming, HTTP-streaming transport, emulation endpoint for SSE/HTTP-stream bidirectional communication, and gRPC API connectivity",
  "baseUrl": "http://localhost:8089",
  "transports": {
    "websocket": "/connection/websocket",
    "sse": "/connection/sse",
    "http_stream": "/connection/http_stream",
    "uni_sse": "/connection/uni_sse",
    "uni_http_stream": "/connection/uni_http_stream",
    "emulation": "/emulation",
    "http_api": "/api",
    "grpc_api_port": 10000
  },
  "steps": [
    "Navigate to the Centrifugo admin UI at http://localhost:8089/",
    "Verify the admin dashboard loads showing a top navigation bar with 'Centrifugo' logo, 'Status' tab, 'Actions' tab, and a settings icon on the right",
    "Verify the Status page displays three summary cards: 'NODES RUNNING: 1', 'TOTAL CLIENTS: 0', and 'TOTAL SUBS: 0'",
    "Verify the detailed status table shows columns: Node name, Version, Uptime, Clients, Users, Subs, Channels with one row showing version '6.6.0 OSS' and all client/channel counts at 0",
    "Click the 'Actions' tab in the navigation bar",
    "Verify the Actions page loads showing 'Execute server API command' heading, a Method dropdown defaulting to 'Publish', a Channel text field, an Idempotency Key field, Tag key/value fields, a JSON editor area, and a 'Publish' button",
    "Click the Method dropdown and verify all available API methods are listed: Publish, Broadcast, Presence, Presence Stats, History, History Remove, Subscribe, Unsubscribe, Disconnect, Info, RPC, and Channels",
    "Select 'Info' from the Method dropdown",
    "Verify the form simplifies to show only the Method dropdown and an 'Info' button",
    "Click the 'Info' button to execute the Info API call",
    "Verify the response section appears showing a 'Request' block with the JSON '{\"method\": \"info\", \"params\": {}}' and a 'Response OK' block with a JSON containing a 'nodes' array with one node entry showing version '6.6.0 OSS', uptime, and zero counts for clients, users, channels, and subs",
    "Select 'Publish' from the Method dropdown",
    "Enter 'test-channel' in the Channel text field",
    "Type '{\"message\": \"Hello from admin UI\", \"timestamp\": \"2026-02-09\"}' in the JSON editor area",
    "Click the 'Publish' button",
    "Verify the response section shows 'Response OK' with an empty result '{}' confirming the message was published successfully",
    "Select 'Channels' from the Method dropdown and click the 'Channels' button",
    "Verify the response shows a 'channels' object in the result (it may be empty if no active subscribers)",
    "Select 'Subscribe' from the Method dropdown",
    "Verify the form shows 'User ID' (required) and 'Channel' (required) fields and a 'Subscribe' button",
    "Enter 'test-user-1' in the User ID field and 'notifications' in the Channel field",
    "Click the 'Subscribe' button",
    "Verify the response shows 'Response OK' confirming the server-side subscription was created",
    "Select 'Presence' from the Method dropdown, enter 'notifications' in the Channel field, and click the 'Presence' button",
    "Verify the response returns presence information for the 'notifications' channel (may show the subscribed user or empty if presence requires active client connections)",
    "Select 'Presence Stats' from the Method dropdown, enter 'notifications' in the Channel field, and click the 'Presence Stats' button",
    "Verify the response returns presence statistics with 'num_clients' and 'num_users' fields",
    "Select 'Publish' from the Method dropdown, enter 'notifications' in the Channel field, type '{\"alert\": \"System update\", \"level\": \"info\"}' in the JSON editor, and click 'Publish'",
    "Verify the publish succeeds with 'Response OK'",
    "Select 'History' from the Method dropdown, enter 'notifications' in the Channel field, and click the 'History' button",
    "Verify the response returns history data for the channel (may show publications if history is configured, or an error if history is not enabled for the channel)",
    "Select 'Broadcast' from the Method dropdown",
    "Verify the form shows a 'Channels' field (for multiple channels) and a JSON editor for the data payload",
    "Enter 'channel-a, channel-b, channel-c' in the Channels field and type '{\"event\": \"broadcast-test\"}' in the JSON editor, then click 'Broadcast'",
    "Verify the response shows 'Response OK' confirming the message was broadcast to all specified channels",
    "Select 'Unsubscribe' from the Method dropdown, enter 'test-user-1' in the User ID field and 'notifications' in the Channel field, and click 'Unsubscribe'",
    "Verify the response shows 'Response OK' confirming the user was unsubscribed from the channel",
    "Select 'Disconnect' from the Method dropdown, enter 'test-user-1' in the User ID field, and click 'Disconnect'",
    "Verify the response shows 'Response OK' confirming the disconnect command was processed",
    "Click the 'Status' tab to return to the dashboard",
    "Verify the Status page still shows the node running with updated uptime value",
    "Open a new browser tab or use a WebSocket client tool to connect to ws://localhost:8089/connection/websocket",
    "Send a connect command '{\"connect\":{}, \"id\": 1}' over the WebSocket connection",
    "Verify the WebSocket server responds with a connect result containing a 'client' ID string and 'version' field",
    "Send a subscribe command '{\"subscribe\":{\"channel\":\"ws-test\"}, \"id\": 2}' over the WebSocket connection",
    "Verify the server responds with a successful subscribe result for the 'ws-test' channel",
    "From the admin UI Actions page, publish a message to 'ws-test' channel with data '{\"text\": \"WebSocket delivery test\"}'",
    "Verify the WebSocket client receives the published message in real-time as a push containing the data '{\"text\": \"WebSocket delivery test\"}'",
    "Send a presence command '{\"presence\":{\"channel\":\"ws-test\"}, \"id\": 3}' over the WebSocket connection",
    "Verify the server responds with presence data showing the current client in the 'ws-test' channel",
    "Send an unsubscribe command '{\"unsubscribe\":{\"channel\":\"ws-test\"}, \"id\": 4}' over the WebSocket connection",
    "Verify the server responds with a successful unsubscribe result",
    "Close the WebSocket connection and verify it disconnects cleanly",
    "Open a connection to the SSE endpoint at http://localhost:8089/connection/sse by sending a POST request with Content-Type application/json and a connect command in the body",
    "Verify the SSE endpoint responds with HTTP 200 and Content-Type 'text/event-stream' indicating the SSE stream is established",
    "Verify the SSE stream sends an initial connect event containing a 'client' ID",
    "From the admin UI, publish a message to a channel the SSE client is subscribed to",
    "Verify the SSE client receives the message as a 'data:' event in the event stream",
    "Close the SSE connection",
    "Open a connection to the unidirectional SSE endpoint at http://localhost:8089/connection/uni_sse with a connect command as a query parameter or POST body",
    "Verify the uni SSE endpoint responds with HTTP 200 and Content-Type 'text/event-stream'",
    "Verify the uni SSE stream delivers a connect event with client information",
    "Close the uni SSE connection",
    "Open a connection to the HTTP-streaming endpoint at http://localhost:8089/connection/http_stream by sending a POST request with Content-Type application/json and a connect command",
    "Verify the HTTP-streaming endpoint responds with HTTP 200 and starts streaming newline-delimited JSON responses",
    "Verify the first streamed line contains a connect result with a 'client' ID",
    "From the admin UI, publish a message to a channel the HTTP-stream client is subscribed to",
    "Verify the HTTP-stream client receives the message as a new JSON line in the stream",
    "Close the HTTP-stream connection",
    "Open a connection to the unidirectional HTTP-streaming endpoint at http://localhost:8089/connection/uni_http_stream by sending a POST request with a connect command",
    "Verify the uni HTTP-stream endpoint responds with HTTP 200 and starts streaming JSON data",
    "Close the uni HTTP-stream connection",
    "Send a POST request to the emulation endpoint at http://localhost:8089/emulation to verify it accepts bidirectional commands for SSE/HTTP-stream clients",
    "Verify the emulation endpoint processes the command and returns a response (or appropriate error if no active session)",
    "Verify the gRPC API is listening by checking that port 10000 is open inside the container (the server log confirms 'serving GRPC API service on :10000')",
    "Use a gRPC client to connect to the Centrifugo gRPC API at localhost:10000 (note: the gRPC port is internal to the container and may need port mapping for external access)",
    "Send a gRPC Info request to the Centrifugo gRPC API",
    "Verify the gRPC response contains node information matching what the HTTP API returns (version, clients, channels, etc.)",
    "Send a gRPC Publish request with channel 'grpc-test' and data '{\"source\": \"grpc\"}' to the gRPC API",
    "Verify the gRPC publish succeeds and confirm via the HTTP API Channels method or a connected WebSocket client that the message was delivered",
    "Return to the Centrifugo admin UI and click the settings icon in the top right corner",
    "Verify the Settings page loads showing a 'Settings' heading, an 'Enable dark theme' toggle switch, and a 'Drop saved settings, tokens and restart' button",
    "Click the 'Enable dark theme' toggle switch",
    "Verify the admin UI switches to dark theme with a dark background",
    "Click the 'Enable dark theme' toggle again to switch back to light theme",
    "Verify the admin UI returns to the default light theme",
    "Click the 'Status' tab and verify the Uptime value in the node table has been incrementing, confirming the server is stable and running throughout all tests",
    "From the admin UI Actions page, run a final 'Info' command and verify the node metrics show non-zero counts for 'centrifugo.api.command_duration_seconds.count.method.info' confirming all the API calls made during testing were tracked"
  ]
}
